(this["webpackJsonpterra-pools"]=this["webpackJsonpterra-pools"]||[]).push([[0],{174:function(e,t){},595:function(e,t){},597:function(e,t){},607:function(e,t){},609:function(e,t){},621:function(e,t){},623:function(e,t){},708:function(e,t){},710:function(e,t){},718:function(e,t){},756:function(e,t,n){},757:function(e,t,n){},892:function(e,t,n){"use strict";n.r(t);var a=n(37),r=n(0),o=n.n(r),i=n(196),s=n.n(i),c=n(158),u=(n(756),n(7)),l=n(24),d=n(2),m=n.n(d),b=(n(757),n(30)),j=n(902),f=n(466),v=n(462),h=n(460),p=n(453),x=n(463);function O(e,t,n,a,r,o){var i=w(e,"usdr",n);if(!i)throw new Error("Invalid base rate (sdr) for ".concat(e.denom));var s,c,u=w(i,t,n),l=new b.Dec(a.pow(2)),d=a.add(o),m=l.div(d);"uluna"===e.denom?(s=m,c=d):(s=d,c=m);var j=c.sub(l.div(s.plus(i.amount))),f=i.amount,v=f.sub(j).div(f);return v.lessThan(r)&&(v=r),[u,v]}function w(e,t,n){var a,r,o;if(e.denom==t)return e;var i=null===(a=n.get(e.denom))||void 0===a?void 0:a.amount;if(!i)throw new Error("Invalid offer rate (uluna) for "+e.denom);var s="uluna"==t?new b.Dec(1):null===(r=n.get(t))||void 0===r?void 0:r.amount;if(!s)throw new Error("Invalid ask rate (uluna) for "+t);var c=null!==(o=e.amount.times(s).dividedBy(i))&&void 0!==o?o:new b.Dec(0);if(c.lessThanOrEqualTo(0))throw new Error("Invalid return amount");return new b.Coin(t,c)}function g(e,t,n,a){var r=0;switch(a){case"T":r=e/1e12;break;case"B":r=e/1e9;break;case"M":r=e/1e6;break;case"K":r=e/1e3;break;case"":r=e}!1!==t&&(new RegExp("\\.\\d{"+(t+1)+",}$").test(""+r)&&(r=r.toFixed(t)));return!1!==n&&(r=Number(r).toFixed(n)),r+a}var k=n(35),y=["#0088FE","#FFBB28"],F=1e5;var S=function(){var e,t,n,a=Object(c.c)(),i=Object(r.useState)([]),s=Object(l.a)(i,2),d=s[0],w=s[1],S=Object(r.useState)(),T=Object(l.a)(S,2),E=T[0],R=T[1],B=Object(r.useState)(!0),C=Object(l.a)(B,2),D=C[0],L=C[1],M=Object(r.useState)([[],[49e6,51e6],0]),N=Object(l.a)(M,2),I=N[0],A=N[1],K=Object(l.a)(I,3),P=K[0],_=K[1],W=K[2];Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(m.a.mark((function e(){var t,n,r,o,i,s,c,u,l,d,j,f,v,h,p,x;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.market.poolDelta();case 2:return t=e.sent,e.next=5,a.oracle.exchangeRates();case 5:return n=e.sent,e.next=8,a.market.parameters();case 8:return r=e.sent,o=r.base_pool,i=r.min_stability_spread,s=o.plus(t),c=o.pow(2).div(s),u=s.times(1e-6).toNumber(),l=c.times(1e-6).toNumber(),R(t),d=O(new b.Coin("uusd",1e11),"uluna",n,o,i,t),w(d),j=Math.min(u,l)-1e6,f=Math.max(u,l)+1e6,v=[j,f],e.next=23,a.market.swapRate(new b.Coin("uusd",1e9),"uluna");case 23:return h=e.sent,e.next=26,a.oracle.exchangeRate("uusd");case 26:p=e.sent,x=1e3/p.amount.toNumber(),A([[{name:"Stablecoins",amt:u},{name:"LUNA",amt:l}],v,100-h.amount.times(1e-6).toNumber()/x*100]);case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e();var t=setInterval(e,7e3);return function(){clearTimeout(t)}}),[a.market,a.oracle]);var $=o.a.memo((function(){return Object(k.jsxs)(j.a,{width:800,height:500,data:P,children:[Object(k.jsxs)(f.a,{isAnimationActive:D,onAnimationEnd:function(){return L(!1)},label:!1,dataKey:"amt",children:[P.map((function(e,t){return Object(k.jsx)(v.a,{fill:y[t%20]},"cell-".concat(t))})),Object(k.jsx)(h.a,{dataKey:"name",position:"top",fill:"#000"}),Object(k.jsx)(h.a,{formatter:function(e){return t=e,n=3,a=3,r="M",t=Number(t),!1!==(r=r||!1)?g(t,n,a,r):g(t,n,a,t>=1e12?"T":t>=1e9?"B":t>=1e6?"M":t>=1e3?"K":"");var t,n,a,r},dataKey:"amt",position:"inside",fill:"#000000"})]}),Object(k.jsx)(p.a,{isFront:!1,label:{position:"top",value:"BasePool (in SDR)"},y:5e7,stroke:"#000"}),Object(k.jsx)(x.a,{hide:!0,type:"number",ticks:10,stroke:"#000000",interval:0,domain:_})]})}),[P]);if(!d)return"Loading...";var J,U,q=null===(e=d[0])||void 0===e?void 0:e.amount.div(1e6),z=null===(J=d[0],U=d[1],t=J?new b.Coin(J.denom,J.amount.minus(J.amount.times(U))):null)||void 0===t?void 0:t.amount.div(1e6);return Object(k.jsxs)("div",{className:"App",style:{textAlign:"left",marginLeft:"auto",marginRight:"auto",maxWidth:800},children:[Object(k.jsxs)("h2",{style:{lineHeight:"1.2rem"},children:["Relationship between Luna / Terra Stable assets in the Market module",Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{fontWeight:"normal",fontSize:"16px"},children:["(live view, updated every block):"," "]})]}),Object(k.jsx)($,{}),Object(k.jsx)("hr",{}),Object(k.jsxs)("div",{children:["Current delta: ",null===E||void 0===E?void 0:E.div(1e6).toFixed(4)," SDR"]}),q&&Object(k.jsxs)("div",{children:["Oracle Rate: ",F," ust = ",q.toFixed(2)," luna ($",(F/q).toFixed(4)," per luna)"]}),z&&Object(k.jsxs)("div",{children:["With ",null===(n=d[1])||void 0===n?void 0:n.times(100).toFixed(2)," % spread fee:"," ",F," ust = ",z.toFixed(2)," luna ($",(F/z).toFixed(4)," per luna)"]}),Object(k.jsx)("hr",{}),Object(k.jsxs)("p",{children:["Estimated fee for a 1000 UST to Luna swap based on current pool weights:"," ",W.toFixed(2),"% ",Object(k.jsx)("br",{}),Object(k.jsxs)("sub",{children:["Pool values above are displayed in"," ",Object(k.jsx)("a",{rel:"noreferrer",target:"_blank",href:"https://docs.terra.money/docs/learn/glossary.html#sdr",children:"TerraSDR"}),"."]})]}),Object(k.jsxs)("p",{children:["Learn more:"," ",Object(k.jsx)("a",{href:"https://docs.terra.money/docs/develop/module-specifications/spec-market.html",children:"Terra docs on the Market module."})]})]})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,903)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),o(e),i(e)}))};Object(c.b)().then((function(e){s.a.render(Object(k.jsx)(o.a.StrictMode,{children:Object(k.jsx)(c.a,Object(a.a)(Object(a.a)({},e),{},{children:Object(k.jsx)(S,{})}))}),document.getElementById("root"))})),T()}},[[892,1,2]]]);
//# sourceMappingURL=main.d16eddfa.chunk.js.map